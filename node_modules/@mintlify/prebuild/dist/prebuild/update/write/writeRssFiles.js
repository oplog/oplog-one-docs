import fse from 'fs-extra';
import { docsConfigToRss } from '../rss/docsConfigToRss.js';
import { mdxToRssUpdates } from '../rss/mdxToRssUpdates.js';
import { pageToRss } from '../rss/pageToRss.js';
export const writeRssFiles = async (docsConfig, rssPages) => {
    const { orgName, orgDescription } = docsConfigToRss(docsConfig);
    const rssTargetPath = 'src/_props/rssFiles.json';
    const rssItemsToSave = rssPages.map((page) => {
        const { targetPath, tree } = page;
        const { title, description } = pageToRss(tree);
        const rssPath = targetPath.replace('.mdx', '/rss');
        const updates = mdxToRssUpdates(tree);
        return {
            rssPath,
            orgName,
            orgDescription,
            title,
            description,
            updates,
        };
    });
    await fse.remove(rssTargetPath);
    await fse.outputFile(rssTargetPath, JSON.stringify(rssItemsToSave), {
        flag: 'w',
    });
};
